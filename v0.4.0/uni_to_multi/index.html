<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Univariate to Multivariate · SliceSampling.jl</title><meta name="title" content="Univariate to Multivariate · SliceSampling.jl"/><meta property="og:title" content="Univariate to Multivariate · SliceSampling.jl"/><meta property="twitter:title" content="Univariate to Multivariate · SliceSampling.jl"/><meta name="description" content="Documentation for SliceSampling.jl."/><meta property="og:description" content="Documentation for SliceSampling.jl."/><meta property="twitter:description" content="Documentation for SliceSampling.jl."/><meta property="og:url" content="https://TuringLang.org/SliceSampling.jl/uni_to_multi/"/><meta property="twitter:url" content="https://TuringLang.org/SliceSampling.jl/uni_to_multi/"/><link rel="canonical" href="https://TuringLang.org/SliceSampling.jl/uni_to_multi/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SliceSampling.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../general/">General Usage</a></li><li><a class="tocitem" href="../univariate_slice/">Univariate Slice Sampling</a></li><li class="is-active"><a class="tocitem" href>Univariate to Multivariate</a><ul class="internal"><li><a class="tocitem" href="#Random-Permutation-Gibbs-Strategy"><span>Random Permutation Gibbs Strategy</span></a></li><li><a class="tocitem" href="#Hit-and-Run-Strategy"><span>Hit-and-Run Strategy</span></a></li></ul></li><li><a class="tocitem" href="../latent_slice/">Latent Slice Sampling</a></li><li><a class="tocitem" href="../gibbs_polar/">Gibbsian Polar Slice Sampling</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Univariate to Multivariate</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Univariate to Multivariate</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TuringLang/SliceSampling.jl/blob/main/docs/src/uni_to_multi.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="unitomulti"><a class="docs-heading-anchor" href="#unitomulti">Univariate-to-Multivariate Strategies</a><a id="unitomulti-1"></a><a class="docs-heading-anchor-permalink" href="#unitomulti" title="Permalink"></a></h1><p>To use univariate slice sampling strategies on targets with more than on dimension, one has to embed them into a multivariate sampling scheme that relies on univariate sampling elements. The two most popular approaches for this are Gibbs sampling<sup class="footnote-reference"><a id="citeref-GG1984" href="#footnote-GG1984">[GG1984]</a></sup> and hit-and-run<sup class="footnote-reference"><a id="citeref-BRS1993" href="#footnote-BRS1993">[BRS1993]</a></sup>.</p><h2 id="Random-Permutation-Gibbs-Strategy"><a class="docs-heading-anchor" href="#Random-Permutation-Gibbs-Strategy">Random Permutation Gibbs Strategy</a><a id="Random-Permutation-Gibbs-Strategy-1"></a><a class="docs-heading-anchor-permalink" href="#Random-Permutation-Gibbs-Strategy" title="Permalink"></a></h2><p>Gibbs sampling<sup class="footnote-reference"><a id="citeref-GG1984" href="#footnote-GG1984">[GG1984]</a></sup> is a strategy where we sample from the posterior one coordinate at a time, conditioned on the values of all other coordinates. In practice, one can pick the coordinates in any order they want as long as it does not depend on the state of the chain. It is generally hard to know a-prior which &quot;scan order&quot; is best, but randomly picking coordinates tend to work well in general. Currently, we only provide random permutation scan, which guarantees that all coordinates are updated at least once after <span>$d$</span> transitions. At the same time, reversibility is maintained by randomly permuting the order we go through each coordinate:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SliceSampling.RandPermGibbs" href="#SliceSampling.RandPermGibbs"><code>SliceSampling.RandPermGibbs</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RandPermGibbs(unislice)</code></pre><p>Random permutation coordinate-wise Gibbs sampling strategy. This applies <code>unislice</code> coordinate-wise in a random order.</p><p><strong>Arguments</strong></p><ul><li><code>unislice::Union{&lt;:AbstractUnivariateSliceSampling,&lt;:AbstractVector{&lt;:AbstractUnivariateSliceSampling}}</code>: a single or a vector of univariate slice sampling algorithms.</li></ul><p>When <code>unislice</code> is a vector of samplers, each slice sampler is applied to the corresponding coordinate of the target posterior. Furthermore, the <code>length(unislice)</code> must match the dimensionality of the posterior.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/SliceSampling.jl/blob/3543cde523d3fb80827279893ea6773b2a89ca77/src/randpermgibbs.jl#L2-L13">source</a></section></article><p>Each call to <code>AbstractMCMC.step</code> internally performs <span>$d$</span> Gibbs transition so that all coordinates are updated.</p><p>For example:</p><pre><code class="language-julia hljs">RandPermGibbs(SliceSteppingOut(2.))</code></pre><p>If one wants to use a different slice sampler configuration for each coordinate, one can mix-and-match by passing a <code>Vector</code> of slice samplers, one for each coordinate. For instance, for a 2-dimensional target:</p><pre><code class="language-julia hljs">RandPermGibbs([SliceSteppingOut(2.; max_proposals=32), SliceDoublingOut(2.),])</code></pre><h2 id="Hit-and-Run-Strategy"><a class="docs-heading-anchor" href="#Hit-and-Run-Strategy">Hit-and-Run Strategy</a><a id="Hit-and-Run-Strategy-1"></a><a class="docs-heading-anchor-permalink" href="#Hit-and-Run-Strategy" title="Permalink"></a></h2><p>Hit-and-run is a simple &quot;meta&quot; algorithm, where we sample over a random 1-dimensional projection of the space. That is, at each iteration, we sample a random direction</p><p class="math-container">\[    \theta_n \sim \operatorname{Uniform}(\mathbb{S}^{d-1}),\]</p><p>and perform a Markov transition along the 1-dimensional subspace</p><p class="math-container">\[\begin{aligned}
    \lambda_n &amp;\sim p\left(\lambda \mid x_{n-1}, \theta_n \right) \propto \pi\left( x_{n-1} + \lambda \theta_n \right) \\
    x_{n} &amp;= x_{n-1} + \lambda_n \theta_n,
\end{aligned}\]</p><p>where <span>$\pi$</span> is the target unnormalized density. Applying slice sampling for the 1-dimensional subproblem has been popularized by David Mackay<sup class="footnote-reference"><a id="citeref-M2003" href="#footnote-M2003">[M2003]</a></sup>, and is, technically, also a Gibbs sampler.  (Or is that Gibbs samplers are hit-and-run samplers?) Unlike <code>RandPermGibbs</code>, which only makes axis-aligned moves, <code>HitAndRun</code> can choose arbitrary directions, which could be helpful in some cases.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SliceSampling.HitAndRun" href="#SliceSampling.HitAndRun"><code>SliceSampling.HitAndRun</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HitAndRun(unislice)</code></pre><p>Hit-and-run sampling strategy<sup class="footnote-reference"><a id="citeref-BRS1993" href="#footnote-BRS1993">[BRS1993]</a></sup>. This applies <code>unislice</code> along a random direction uniform sampled from the sphere.</p><p><strong>Arguments</strong></p><ul><li><code>unislice::AbstractUnivariateSliceSampling</code>: Univariate slice sampling algorithm.</li></ul><p><code>unislice</code> can also be a vector of univeriate slice samplers, where each slice sampler is applied to each corresponding coordinate of the target posterior.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TuringLang/SliceSampling.jl/blob/3543cde523d3fb80827279893ea6773b2a89ca77/src/hitandrun.jl#L2-L12">source</a></section></article><p>This can be used, for example, as follows:</p><pre><code class="language-julia hljs">HitAndRun(SliceSteppingOut(2.))</code></pre><p>Unlike <code>RandPermGibbs</code>, <code>HitAndRun</code> does not provide the option of using a unique <code>unislice</code> object for each coordinate. This is a natural limitation of the hit-and-run sampler: it does not operate on individual coordinates.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-GG1984"><a class="tag is-link" href="#citeref-GG1984">GG1984</a>Geman, S., &amp; Geman, D. (1984). Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images. IEEE Transactions on Pattern Analysis and Machine Intelligence, (6).</li><li class="footnote" id="footnote-BRS1993"><a class="tag is-link" href="#citeref-BRS1993">BRS1993</a>Bélisle, C. J., Romeijn, H. E., &amp; Smith, R. L. (1993). Hit-and-run algorithms for generating multivariate distributions. Mathematics of Operations Research, 18(2), 255-266.</li><li class="footnote" id="footnote-M2003"><a class="tag is-link" href="#citeref-M2003">M2003</a>MacKay, D. J. (2003). Information theory, inference and learning algorithms. Cambridge university press.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../univariate_slice/">« Univariate Slice Sampling</a><a class="docs-footer-nextpage" href="../latent_slice/">Latent Slice Sampling »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Wednesday 29 May 2024 07:30">Wednesday 29 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
